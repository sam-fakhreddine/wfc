# Dockerfile for archlinux:base
FROM archlinux:base

# Set working directory
WORKDIR /wfc

# Install basic dependencies and test requirements
# Arch Linux specific setup
RUN pacman -Syu --noconfirm     curl     git     python     python-pip     bash     && pacman -Scc --noconfirm

# Copy WFC source code
COPY . /

# Create Claude Code directory structure
RUN mkdir -p /home/sambou/.claude/skills

# Create test environment setup script
RUN echo '#!/bin/bash' > /test-setup.sh &&     echo 'export HOME=/home/sambou' >> /test-setup.sh &&     echo 'echo "Test environment initialized"' >> /test-setup.sh &&     chmod +x /test-setup.sh

# Run the installer with test setup
CMD ["/bin/bash", "-c", "source /test-setup.sh && /install-universal.sh --ci && echo 'Installation completed successfully'"]
